<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="multiassayexperiment" href="api/modules.html" /><link rel="prev" title="MultiAssayExperiment" href="index.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Multiple experiments - MultiAssayExperiment 0.5.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">MultiAssayExperiment 0.5.2 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">MultiAssayExperiment 0.5.2 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api/modules.html">Module Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Module Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="api/multiassayexperiment.html">multiassayexperiment package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of multiassayexperiment package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="api/multiassayexperiment.io.html">multiassayexperiment.io package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributions &amp; Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/overview.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="multiple-experiments">
<h1>Multiple experiments<a class="headerlink" href="#multiple-experiments" title="Link to this heading">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">MultiAssayExperiment</span></code> (MAE) simplifies the management of multiple experimental assays conducted on a shared set of specimens.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These classes follow a functional paradigm for accessing or setting properties, with further details discussed in <a class="reference external" href="https://biocpy.github.io/tutorial/chapters/philosophy.html#functional-discipline">functional paradigm</a> section.</p>
</div>
<section id="construction">
<h2>Construction<a class="headerlink" href="#construction" title="Link to this heading">¶</a></h2>
<p>An MAE contains three main entities,</p>
<ul>
<li><p><strong>Primary information</strong> (<code class="docutils literal notranslate"><span class="pre">column_data</span></code>): Bio-specimen/sample information. The <code class="docutils literal notranslate"><span class="pre">column_data</span></code> may provide information about patients, cell lines, or other biological units. Each row in this table represents an independent biological unit. It must contain an <code class="docutils literal notranslate"><span class="pre">index</span></code> that maps to the ‘primary’ in <code class="docutils literal notranslate"><span class="pre">sample_map</span></code>.</p></li>
<li><p><strong>Experiments</strong> (<code class="docutils literal notranslate"><span class="pre">experiments</span></code>): Genomic data from each experiment. either a <code class="docutils literal notranslate"><span class="pre">SingleCellExperiment</span></code>, <code class="docutils literal notranslate"><span class="pre">SummarizedExperiment</span></code>, <code class="docutils literal notranslate"><span class="pre">RangedSummarizedExperiment</span></code> or any class that extends a <code class="docutils literal notranslate"><span class="pre">SummarizedExperiment</span></code>.</p></li>
<li><p><strong>Sample Map</strong> (<code class="docutils literal notranslate"><span class="pre">sample_map</span></code>): Map biological units from <code class="docutils literal notranslate"><span class="pre">column_data</span></code> to the list of <code class="docutils literal notranslate"><span class="pre">experiments</span></code>. Must contain columns,</p>
<ul class="simple">
<li><p><strong>assay</strong> provides the names of the different experiments performed on the biological units. All experiment names from experiments must be present in this column.</p></li>
<li><p><strong>primary</strong> contains the sample name. All names in this column must match with row labels from col_data.</p></li>
<li><p><strong>colname</strong> is the mapping of samples/cells within each experiment back to its biosample information in col_data.</p></li>
</ul>
<p>Each sample in <code class="docutils literal notranslate"><span class="pre">column_data</span></code> may map to one or more columns per assay.</p>
</li>
</ul>
<p>Let’s start by first creating few experiments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">random</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">biocframe</span><span class="w"> </span><span class="kn">import</span> <span class="n">BiocFrame</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">genomicranges</span><span class="w"> </span><span class="kn">import</span> <span class="n">GenomicRanges</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">iranges</span><span class="w"> </span><span class="kn">import</span> <span class="n">IRanges</span>

<span class="n">nrows</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">)</span>
<span class="n">gr</span> <span class="o">=</span> <span class="n">GenomicRanges</span><span class="p">(</span>
    <span class="n">seqnames</span><span class="o">=</span><span class="p">[</span>
            <span class="s2">&quot;chr1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chr2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chr2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chr2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chr1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chr1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chr3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chr3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chr3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chr3&quot;</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">ranges</span><span class="o">=</span><span class="n">IRanges</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="mi">310</span><span class="p">)),</span>
    <span class="n">strand</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">mcols</span><span class="o">=</span><span class="n">BiocFrame</span><span class="p">({</span>
        <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
        <span class="s2">&quot;GC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">})</span>
<span class="p">)</span>

<span class="n">col_data_sce</span> <span class="o">=</span> <span class="n">BiocFrame</span><span class="p">({</span><span class="s2">&quot;treatment&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ChIP&quot;</span><span class="p">,</span> <span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">},</span>
    <span class="n">row_names</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;sce_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span>
<span class="p">)</span>

<span class="n">col_data_se</span> <span class="o">=</span> <span class="n">BiocFrame</span><span class="p">({</span><span class="s2">&quot;treatment&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ChIP&quot;</span><span class="p">,</span> <span class="s2">&quot;Input&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">},</span>
    <span class="n">row_names</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;se_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>More importantly, we need to provide <code class="docutils literal notranslate"><span class="pre">sample_map</span></code> information:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_map</span> <span class="o">=</span> <span class="n">BiocFrame</span><span class="p">({</span>
    <span class="s2">&quot;assay&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sce&quot;</span><span class="p">,</span> <span class="s2">&quot;se&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s2">&quot;primary&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sample1&quot;</span><span class="p">,</span> <span class="s2">&quot;sample2&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span>
    <span class="s2">&quot;colname&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sce_0&quot;</span><span class="p">,</span> <span class="s2">&quot;se_0&quot;</span><span class="p">,</span> <span class="s2">&quot;sce_1&quot;</span><span class="p">,</span> <span class="s2">&quot;se_1&quot;</span><span class="p">,</span> <span class="s2">&quot;sce_2&quot;</span><span class="p">,</span> <span class="s2">&quot;se_2&quot;</span><span class="p">,</span> <span class="s2">&quot;sce_3&quot;</span><span class="p">,</span> <span class="s2">&quot;se_3&quot;</span><span class="p">,</span> <span class="s2">&quot;sce_4&quot;</span><span class="p">,</span> <span class="s2">&quot;se_4&quot;</span><span class="p">,</span> <span class="s2">&quot;sce_5&quot;</span><span class="p">,</span> <span class="s2">&quot;se_5&quot;</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">sample_data</span> <span class="o">=</span> <span class="n">BiocFrame</span><span class="p">({</span><span class="s2">&quot;samples&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sample1&quot;</span><span class="p">,</span> <span class="s2">&quot;sample2&quot;</span><span class="p">]},</span> <span class="n">row_names</span><span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sample1&quot;</span><span class="p">,</span> <span class="s2">&quot;sample2&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sample_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BiocFrame with 12 rows and 3 columns
      assay primary colname
     &lt;list&gt;  &lt;list&gt;  &lt;list&gt;
 [0]    sce sample1   sce_0
 [1]     se sample2    se_0
 [2]    sce sample1   sce_1
        ...     ...     ...
 [9]     se sample2    se_4
[10]    sce sample1   sce_5
[11]     se sample2    se_5
</pre></div>
</div>
</div>
</div>
<p>Finally, we can create an <code class="docutils literal notranslate"><span class="pre">MultiAssayExperiment</span></code> object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">multiassayexperiment</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiAssayExperiment</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">singlecellexperiment</span><span class="w"> </span><span class="kn">import</span> <span class="n">SingleCellExperiment</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">summarizedexperiment</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummarizedExperiment</span>

<span class="n">tsce</span> <span class="o">=</span> <span class="n">SingleCellExperiment</span><span class="p">(</span>
    <span class="n">assays</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;counts&quot;</span><span class="p">:</span> <span class="n">counts</span><span class="p">},</span> <span class="n">row_data</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(),</span> <span class="n">column_data</span><span class="o">=</span><span class="n">col_data_sce</span>
<span class="p">)</span>

<span class="n">tse2</span> <span class="o">=</span> <span class="n">SummarizedExperiment</span><span class="p">(</span>
    <span class="n">assays</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;counts&quot;</span><span class="p">:</span> <span class="n">counts</span><span class="o">.</span><span class="n">copy</span><span class="p">()},</span>
    <span class="n">row_data</span><span class="o">=</span><span class="n">gr</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
    <span class="n">column_data</span><span class="o">=</span><span class="n">col_data_se</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span>
<span class="p">)</span>

<span class="n">mae</span> <span class="o">=</span> <span class="n">MultiAssayExperiment</span><span class="p">(</span>
    <span class="n">experiments</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sce&quot;</span><span class="p">:</span> <span class="n">tsce</span><span class="p">,</span> <span class="s2">&quot;se&quot;</span><span class="p">:</span> <span class="n">tse2</span><span class="p">},</span>
    <span class="n">column_data</span><span class="o">=</span><span class="n">sample_data</span><span class="p">,</span>
    <span class="n">sample_map</span><span class="o">=</span><span class="n">sample_map</span><span class="p">,</span>
    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;could be&quot;</span><span class="p">:</span> <span class="s2">&quot;anything&quot;</span><span class="p">},</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>class: MultiAssayExperiment containing 2 experiments
[0] sce: SingleCellExperiment with 200 rows and 6 columns 
[1] se: SummarizedExperiment with 200 rows and 6 columns 
column_data columns(1): [&#39;samples&#39;]
sample_map columns(3): [&#39;assay&#39;, &#39;primary&#39;, &#39;colname&#39;]
metadata(1): could be
</pre></div>
</div>
</div>
</div>
<section id="no-sample-mapping">
<h3>No sample mapping?<a class="headerlink" href="#no-sample-mapping" title="Link to this heading">¶</a></h3>
<p>If both <code class="docutils literal notranslate"><span class="pre">column_data</span></code> and <code class="docutils literal notranslate"><span class="pre">sample_map</span></code> are <code class="docutils literal notranslate"><span class="pre">None</span></code>, the constructor naively creates sample mapping, with each <code class="docutils literal notranslate"><span class="pre">experiment</span></code> considered to be a independent <code class="docutils literal notranslate"><span class="pre">sample</span></code>. We add a sample to <code class="docutils literal notranslate"><span class="pre">column_data</span></code> in this pattern - <code class="docutils literal notranslate"><span class="pre">unknown_sample_{experiment_name}</span></code>.</p>
<p>All cells from the each experiment are considered to be from the same sample and is reflected in <code class="docutils literal notranslate"><span class="pre">sample_map</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><em><strong>This is not a recommended approach, but if you don’t have sample mapping, then it doesn’t matter</strong></em>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mae</span> <span class="o">=</span> <span class="n">MultiAssayExperiment</span><span class="p">(</span>
    <span class="n">experiments</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;sce&quot;</span><span class="p">:</span> <span class="n">tsce</span><span class="p">,</span> <span class="s2">&quot;se&quot;</span><span class="p">:</span> <span class="n">tse2</span><span class="p">},</span>
    <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;could be&quot;</span><span class="p">:</span> <span class="s2">&quot;anything&quot;</span><span class="p">},</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>class: MultiAssayExperiment containing 2 experiments
[0] sce: SingleCellExperiment with 200 rows and 6 columns 
[1] se: SummarizedExperiment with 200 rows and 6 columns 
column_data columns(1): [&#39;samples&#39;]
sample_map columns(3): [&#39;assay&#39;, &#39;primary&#39;, &#39;colname&#39;]
metadata(1): could be
</pre></div>
</div>
</div>
</div>
</section>
<section id="interop-with-anndata-or-mudata">
<h3>Interop with <code class="docutils literal notranslate"><span class="pre">anndata</span></code> or <code class="docutils literal notranslate"><span class="pre">mudata</span></code><a class="headerlink" href="#interop-with-anndata-or-mudata" title="Link to this heading">¶</a></h3>
<p>We provide convenient methods to easily convert a <code class="docutils literal notranslate"><span class="pre">MuData</span></code> object into an <code class="docutils literal notranslate"><span class="pre">MultiAssayExperiment</span></code>.</p>
<p>Let’s create a mudata object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">anndata</span><span class="w"> </span><span class="kn">import</span> <span class="n">AnnData</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">adata</span> <span class="o">=</span> <span class="n">AnnData</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;obs_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">adata</span><span class="o">.</span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;var_</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d</span><span class="p">)]</span>

<span class="n">d2</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">w2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">w2</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">adata2</span> <span class="o">=</span> <span class="n">AnnData</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span>
<span class="n">adata2</span><span class="o">.</span><span class="n">obs_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;obs_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">adata2</span><span class="o">.</span><span class="n">var_names</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;var2_</span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">d2</span><span class="p">)]</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mudata</span><span class="w"> </span><span class="kn">import</span> <span class="n">MuData</span>
<span class="n">mdata</span> <span class="o">=</span> <span class="n">MuData</span><span class="p">({</span><span class="s2">&quot;rna&quot;</span><span class="p">:</span> <span class="n">adata</span><span class="p">,</span> <span class="s2">&quot;spatial&quot;</span><span class="p">:</span> <span class="n">adata2</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mdata</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MuData object with n_obs × n_vars = 1000 × 150
  2 modalities
    rna:	1000 x 100
    spatial:	1000 x 50
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/work/MultiAssayExperiment/MultiAssayExperiment/.tox/docs/lib/python3.11/site-packages/mudata/_core/mudata.py:1598: FutureWarning: From 0.4 .update() will not pull obs/var columns from individual modalities by default anymore. Set mudata.set_options(pull_on_update=False) to adopt the new behaviour, which will become the default. Use new pull_obs/pull_var and push_obs/push_var methods for more flexibility.
  self._update_attr(&quot;var&quot;, axis=0, join_common=join_common)
/home/runner/work/MultiAssayExperiment/MultiAssayExperiment/.tox/docs/lib/python3.11/site-packages/mudata/_core/mudata.py:1461: FutureWarning: From 0.4 .update() will not pull obs/var columns from individual modalities by default anymore. Set mudata.set_options(pull_on_update=False) to adopt the new behaviour, which will become the default. Use new pull_obs/pull_var and push_obs/push_var methods for more flexibility.
  self._update_attr(&quot;obs&quot;, axis=1, join_common=join_common)
</pre></div>
</div>
</div>
</div>
<p>Lets convert this object to an <code class="docutils literal notranslate"><span class="pre">MAE</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">multiassayexperiment</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiAssayExperiment</span>

<span class="n">mae_obj</span> <span class="o">=</span> <span class="n">MultiAssayExperiment</span><span class="o">.</span><span class="n">from_mudata</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">mdata</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mae_obj</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>class: MultiAssayExperiment containing 2 experiments
[0] rna: SingleCellExperiment with 100 rows and 1000 columns 
[1] spatial: SingleCellExperiment with 50 rows and 1000 columns 
column_data columns(1): [&#39;samples&#39;]
sample_map columns(3): [&#39;assay&#39;, &#39;primary&#39;, &#39;colname&#39;]
metadata(0): 
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="getters-setters">
<h2>Getters/Setters<a class="headerlink" href="#getters-setters" title="Link to this heading">¶</a></h2>
<p>Getters are available to access various attributes using either the property notation or functional style.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># access assays</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;experiment names (as property): &quot;</span><span class="p">,</span> <span class="n">mae</span><span class="o">.</span><span class="n">experiment_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;experiment names (functional style): &quot;</span><span class="p">,</span> <span class="n">mae</span><span class="o">.</span><span class="n">get_experiment_names</span><span class="p">())</span>

<span class="c1"># access sample data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mae</span><span class="o">.</span><span class="n">column_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>experiment names (as property):  [&#39;sce&#39;, &#39;se&#39;]
experiment names (functional style):  [&#39;sce&#39;, &#39;se&#39;]
BiocFrame with 2 rows and 1 column
                              samples
                               &lt;list&gt;
unknown_sample_sce unknown_sample_sce
 unknown_sample_se  unknown_sample_se
</pre></div>
</div>
</div>
</div>
<p>Check out the <a class="reference external" href="https://biocpy.github.io/MultiAssayExperiment/api/multiassayexperiment.html#multiassayexperiment.MultiAssayExperiment.MultiAssayExperiment">class documentation</a> for the full list of accessors and setters.</p>
<section id="row-or-column-name-accessors">
<h3>Row or column name accessors<a class="headerlink" href="#row-or-column-name-accessors" title="Link to this heading">¶</a></h3>
<p>A helper method is available to easily access row or column names across all experiments. This method returns a dictionary with experiment names as keys and the corresponding values, which can be either the row or column names depending on the function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rich</span><span class="w"> </span><span class="kn">import</span> <span class="nb">print</span> <span class="k">as</span> <span class="n">pprint</span>
<span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;row names:&quot;</span><span class="p">,</span> <span class="n">mae</span><span class="o">.</span><span class="n">get_row_names</span><span class="p">())</span>
<span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;column names:&quot;</span><span class="p">,</span> <span class="n">mae</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span><span class="w"> </span><span class="nn">rich</span><span class="w"> </span><span class="kn">import</span> <span class="nb">print</span> <span class="k">as</span> <span class="n">pprint</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;row names:&quot;</span><span class="p">,</span> <span class="n">mae</span><span class="o">.</span><span class="n">get_row_names</span><span class="p">())</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">pprint</span><span class="p">(</span><span class="s2">&quot;column names:&quot;</span><span class="p">,</span> <span class="n">mae</span><span class="o">.</span><span class="n">get_column_names</span><span class="p">())</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;rich&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="access-an-experiment">
<h3>Access an experiment<a class="headerlink" href="#access-an-experiment" title="Link to this heading">¶</a></h3>
<p>One can access an experiment by name:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mae</span><span class="o">.</span><span class="n">experiment</span><span class="p">(</span><span class="s2">&quot;se&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Additionally you may access an experiment with the sample information included in the column data of the experiment:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This creates a copy of the experiment.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expt_with_sample_info</span> <span class="o">=</span> <span class="n">mae</span><span class="o">.</span><span class="n">experiment</span><span class="p">(</span><span class="s2">&quot;se&quot;</span><span class="p">,</span> <span class="n">with_sample_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">expt_with_sample_info</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For consistency with the R MAE’s interface, we also provide <code class="docutils literal notranslate"><span class="pre">get_with_column_data</span></code> method, that performs the same operation.</p>
</div>
</section>
<section id="setters">
<h3>Setters<a class="headerlink" href="#setters" title="Link to this heading">¶</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All property-based setters are <code class="docutils literal notranslate"><span class="pre">in_place</span></code> operations, with further details discussed in <a class="reference internal" href="#../philosophy.qmd#functional-discipline"><span class="xref myst">functional paradigm</span></a> section.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modified_column_data</span> <span class="o">=</span> <span class="n">mae</span><span class="o">.</span><span class="n">column_data</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mae</span><span class="o">.</span><span class="n">column_data</span><span class="p">)))</span>
<span class="n">modified_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="o">.</span><span class="n">set_column_data</span><span class="p">(</span><span class="n">modified_column_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modified_mae</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, lets check the <code class="docutils literal notranslate"><span class="pre">column_data</span></code> on the original object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mae</span><span class="o">.</span><span class="n">column_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="subsetting">
<h2>Subsetting<a class="headerlink" href="#subsetting" title="Link to this heading">¶</a></h2>
<p>You can subset <code class="docutils literal notranslate"><span class="pre">MultiAssayExperiment</span></code> by using the subset (<code class="docutils literal notranslate"><span class="pre">[]</span></code>) operator. This operation accepts different slice input types, such as a boolean vector, a <code class="docutils literal notranslate"><span class="pre">slice</span></code> object, a list of indices, or names (if available) to subset.</p>
<p><code class="docutils literal notranslate"><span class="pre">MultiAssayExperiment</span></code> allows subsetting by three dimensions: <code class="docutils literal notranslate"><span class="pre">rows</span></code>, <code class="docutils literal notranslate"><span class="pre">columns</span></code>, and <code class="docutils literal notranslate"><span class="pre">experiments</span></code>. <em><strong><code class="docutils literal notranslate"><span class="pre">sample_map</span></code> is automatically filtered during this operation</strong></em>.</p>
<section id="subset-by-indices">
<h3>Subset by indices<a class="headerlink" href="#subset-by-indices" title="Link to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset_mae</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="subset-by-experiments-dimension">
<h3>Subset by experiments dimension<a class="headerlink" href="#subset-by-experiments-dimension" title="Link to this heading">¶</a></h3>
<p>The following creates a subset based on the experiments dimension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;se&quot;</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset_mae</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you’re wondering about why the experiment “se” has 0 columns, it’s important to note that our MAE implementation does not remove columns from an experiment solely because none of the columns map to the samples of interest. This approach aims to prevent unexpected outcomes in complex subset operations.</p>
</div>
</section>
</section>
<section id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">MultiAssayExperiment</span></code> class also provides a few methods for sample management.</p>
<section id="complete-cases">
<h3>Complete cases<a class="headerlink" href="#complete-cases" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">complete_cases</span></code> function is designed to identify samples that contain data across all experiments. It produces a boolean vector with the same length as the number of samples in <code class="docutils literal notranslate"><span class="pre">column_data</span></code>. Each element in the vector is <code class="docutils literal notranslate"><span class="pre">True</span></code> if the sample is present in all experiments, or <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mae</span><span class="o">.</span><span class="n">complete_cases</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>You can use this boolean vector to select samples with complete data across all assays or experiments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">[:,</span> <span class="n">mae</span><span class="o">.</span><span class="n">complete_cases</span><span class="p">(),]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subset_mae</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="replicates">
<h3>Replicates<a class="headerlink" href="#replicates" title="Link to this heading">¶</a></h3>
<p>This method identifies ‘samples’ with replicates within each experiment. The result is a dictionary where experiment names serve as keys, and the corresponding values indicate whether the sample is replicated within each experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rich</span><span class="w"> </span><span class="kn">import</span> <span class="nb">print</span> <span class="k">as</span> <span class="n">pprint</span> <span class="c1"># mainly for pretty printing</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">mae</span><span class="o">.</span><span class="n">replicated</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="intersect-rows">
<h3>Intersect rows<a class="headerlink" href="#intersect-rows" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">intersect_rows</span></code> finds common <code class="docutils literal notranslate"><span class="pre">row_names</span></code> across all experiments and returns a <code class="docutils literal notranslate"><span class="pre">MultiAssayExperiment</span></code> with those rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common_rows_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="o">.</span><span class="n">intersect_rows</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">common_rows_mae</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you are only interested in finding common <code class="docutils literal notranslate"><span class="pre">row_names</span></code> across all experiments:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common_rows</span> <span class="o">=</span> <span class="n">mae</span><span class="o">.</span><span class="n">find_common_row_names</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">common_rows</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="empty-mae">
<h3>Empty MAE<a class="headerlink" href="#empty-mae" title="Link to this heading">¶</a></h3>
<p>While the necessity of an empty <code class="docutils literal notranslate"><span class="pre">MultiAssayExperiment</span></code> might not be apparent, for the sake of consistency with the rest of the tutorials:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mae</span> <span class="o">=</span> <span class="n">MultiAssayExperiment</span><span class="p">(</span><span class="n">experiments</span><span class="o">=</span><span class="p">{})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mae</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api/modules.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">multiassayexperiment</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, jkanche
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Multiple experiments</a><ul>
<li><a class="reference internal" href="#construction">Construction</a><ul>
<li><a class="reference internal" href="#no-sample-mapping">No sample mapping?</a></li>
<li><a class="reference internal" href="#interop-with-anndata-or-mudata">Interop with <code class="docutils literal notranslate"><span class="pre">anndata</span></code> or <code class="docutils literal notranslate"><span class="pre">mudata</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#getters-setters">Getters/Setters</a><ul>
<li><a class="reference internal" href="#row-or-column-name-accessors">Row or column name accessors</a></li>
<li><a class="reference internal" href="#access-an-experiment">Access an experiment</a></li>
<li><a class="reference internal" href="#setters">Setters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#subsetting">Subsetting</a><ul>
<li><a class="reference internal" href="#subset-by-indices">Subset by indices</a></li>
<li><a class="reference internal" href="#subset-by-experiments-dimension">Subset by experiments dimension</a></li>
</ul>
</li>
<li><a class="reference internal" href="#helper-functions">Helper functions</a><ul>
<li><a class="reference internal" href="#complete-cases">Complete cases</a></li>
<li><a class="reference internal" href="#replicates">Replicates</a></li>
<li><a class="reference internal" href="#intersect-rows">Intersect rows</a></li>
<li><a class="reference internal" href="#empty-mae">Empty MAE</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=8e576371"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>